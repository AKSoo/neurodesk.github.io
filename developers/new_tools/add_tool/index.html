<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.88.1"><meta name=ROBOTS content="INDEX, FOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon-180x180.png sizes=180x180>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-36x36.png sizes=36x36>
<link rel=icon type=image/png href=/favicons/android-48x48.png sizes=48x48>
<link rel=icon type=image/png href=/favicons/android-72x72.png sizes=72x72>
<link rel=icon type=image/png href=/favicons/android-96x96.png sizes=96x96>
<link rel=icon type=image/png href=/favicons/android-144x144.png sizes=144x144>
<link rel=icon type=image/png href=/favicons/android-192x192.png sizes=192x192>
<title>Add tools | NeuroDesk</title>
<meta name=description content="Add a tool to neurodesktop
">
<meta property="og:title" content="Add tools">
<meta property="og:description" content="Add a tool to neurodesktop
">
<meta property="og:type" content="article">
<meta property="og:url" content="https://neurodesk.github.io/developers/new_tools/add_tool/"><meta property="article:section" content="developers">
<meta property="article:modified_time" content="2021-09-23T14:07:39+10:00"><meta property="og:site_name" content="NeuroDesk">
<meta itemprop=name content="Add tools">
<meta itemprop=description content="Add a tool to neurodesktop
">
<meta itemprop=dateModified content="2021-09-23T14:07:39+10:00">
<meta itemprop=wordCount content="646">
<meta itemprop=keywords content><meta name=twitter:card content="summary">
<meta name=twitter:title content="Add tools">
<meta name=twitter:description content="Add a tool to neurodesktop
">
<link rel=preload href=/scss/main.min.54a6b13de98a6b564f59b9d4cda427d6ae62ab54c015b5b9f5ed167c2da7fdd5.css as=style>
<link href=/scss/main.min.54a6b13de98a6b564f59b9d4cda427d6ae62ab54c015b5b9f5ed167c2da7fdd5.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<link rel=stylesheet href=/css/prism.css>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga('create','UA-00000000-0','auto'),ga('send','pageview'))</script>
<script async src=https://www.google-analytics.com/analytics.js></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/>
<span class=navbar-logo></span><span class="text-uppercase font-weight-bold">NeuroDesk</span>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/docs/><span>Documentation</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class="nav-link active" href=/developers/><span class=active>Developers</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/tutorials/><span>Tutorials</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=/blog/><span>News</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://github.com/NeuroDesk target=_blank><i class="fab fa-github"></i><span>GitHub</span></a>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block">
<input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
</div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav" id=td-section-nav>
<ul class="td-sidebar-nav__section pr-md-3 ul-0">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-developers-li>
<a href=/developers/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section tree-root" id=m-developers><span>Developers</span></a>
<ul class=ul-1>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-developerscvmfs-li>
<a href=/developers/cvmfs/ title="Neurodesk CVMFS" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-developerscvmfs><span>CVMFS</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developerscvmfsproxy-li>
<a href=/developers/cvmfs/proxy/ title="Setup CVMFS Proxy" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-developerscvmfsproxy><span>Proxy</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developerscvmfsstratum1-li>
<a href=/developers/cvmfs/stratum1/ title="Setup Stratum 1 server" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-developerscvmfsstratum1><span>Stratum 1</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-developersarchitecture-li>
<a href=/developers/architecture/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-developersarchitecture><span>Architecture</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developersarchitecturecvmfs_setup-li>
<a href=/developers/architecture/cvmfs_setup/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-developersarchitecturecvmfs_setup><span>CVMFS architecture</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developersarchitecturerelease_process-li>
<a href=/developers/architecture/release_process/ title="Neurodestkop Release Process" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-developersarchitecturerelease_process><span>Release Process</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developersarchitectureneurodesk-compoents-li>
<a href=/developers/architecture/neurodesk-compoents/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-developersarchitectureneurodesk-compoents><span>Neurodesk Architecture</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-developersnew_tools-li>
<a href=/developers/new_tools/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-developersnew_tools><span>How to add new tools</span></a>
<ul class="ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-developersnew_toolsadd_tool-li>
<a href=/developers/new_tools/add_tool/ class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-developersnew_toolsadd_tool><span class=td-sidebar-nav-active-item>Add tools</span></a>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developersnew_toolsmenu_entries-li>
<a href=/developers/new_tools/menu_entries/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-developersnew_toolsmenu_entries><span>Menu entries</span></a>
</li>
</ul>
</li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-developerstransparent_singularity-li>
<a href=/developers/transparent_singularity/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-developerstransparent_singularity><span>Transparent Singularity</span></a>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside>
<aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
<a href=https://github.com/NeuroDesk/neurodesk.github.io/edit/hugo-docsy/content/en/developers/new_tools/add_tool.md target=_blank><i class="fa fa-edit fa-fw"></i> Edit this page</a>
<a href="https://github.com/NeuroDesk/neurodesk.github.io/new/hugo-docsy/content/en/developers/new_tools/add_tool.md?filename=change-me.md&value=---%0Atitle%3A+%22Long+Page+Title%22%0AlinkTitle%3A+%22Short+Nav+Title%22%0Aweight%3A+100%0Adescription%3A+%3E-%0A+++++Page+description+for+heading+and+indexes.%0A---%0A%0A%23%23+Heading%0A%0AEdit+this+template+to+create+your+new+page.%0A%0A%2A+Give+it+a+good+name%2C+ending+in+%60.md%60+-+e.g.+%60getting-started.md%60%0A%2A+Edit+the+%22front+matter%22+section+at+the+top+of+the+page+%28weight+controls+how+its+ordered+amongst+other+pages+in+the+same+directory%3B+lowest+number+first%29.%0A%2A+Add+a+good+commit+message+at+the+bottom+of+the+page+%28%3C80+characters%3B+use+the+extended+description+field+for+more+detail%29.%0A%2A+Create+a+new+branch+so+you+can+preview+your+new+file+and+request+a+review+via+Pull+Request.%0A" target=_blank><i class="fa fa-edit fa-fw"></i> Create child page</a>
<a href="https://github.com/NeuroDesk/neurodesk.github.io/issues/new?title=Add%20tools" target=_blank><i class="fab fa-github fa-fw"></i> Create documentation issue</a>
<a href=https://github.com/NeuroDesk/neurodesk.github.io/issues/new target=_blank><i class="fas fa-tasks fa-fw"></i> Create project issue</a>
<a id=print href=https://neurodesk.github.io/developers/new_tools/_print/><i class="fa fa-print fa-fw"></i> Print entire section</a>
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#guiding-principles>Guiding principles</a></li>
<li><a href=#adding-new-recipes>Adding new recipes</a></li>
<li><a href=#build-container>Build container</a></li>
</ul>
</nav></div>
</aside>
<main class="col-12 col-md-9 col-xl-8 pl-md-5" role=main>
<div class=td-content>
<h1>Add tools</h1>
<div class=lead>Add a tool to neurodesktop</div>
<header class=article-meta>
</header>
<p>The goal of <em>neurodesk</em> is to provide users with a large choice of tools to use in their pipelines.
Use the guide below to add a tool to <em>neurodesktop</em> or <em>neurocontainers</em>.</p>
<h2 id=guiding-principles>Guiding principles</h2>
<p>To decide if a tool should be packaged in a singularity container in <em>neurocontainers</em> or be installed in the <em>neurodesktop</em> container we are currently following these guiding principles:</p>
<ol>
<li><em>neurodesk</em> is not a package manager. This means we are not distributing tools in containers that can easily be installed via a standard package manager</li>
<li><em>neurodesk</em> allows users to have multiple versions of tools in parallel via <a href=https://lmod.readthedocs.io/en/latest/>lmod</a>, this means that if different versions of a tool can&rsquo;t be installed in parallel we package the tool inside a container.</li>
<li><em>neurodesk</em> aims to provide tooling to link tools from different containers (such as workflow managers like nipype or nextflow). This means that if a tool is required to coordinate various container-tools, it should be in the <em>neurodesktop</em> container.</li>
</ol>
<p>Examples:</p>
<table>
<thead>
<tr>
<th></th>
<th>easy install</th>
<th>coordinates containers</th>
<th>small in size</th>
<th>latest version is ok</th>
<th>useful more most users</th>
<th>Conclusion</th>
</tr>
</thead>
<tbody>
<tr>
<td>git</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>lmod</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>nipype</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>vscode</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>neurodesktop</td>
</tr>
<tr>
<td>itksnap</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>yes</td>
<td>yes</td>
<td>container?</td>
</tr>
<tr>
<td>convert3D</td>
<td>yes</td>
<td>no</td>
<td>yes</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
<tr>
<td>fsl</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
<tr>
<td>mrtrix</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
<tr>
<td>freesurfer</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>no</td>
<td>container</td>
</tr>
</tbody>
</table>
<h2 id=adding-new-recipes>Adding new recipes</h2>
<p>Refer to <a href=https://github.com/NeuroDesk/neurodocker>neurodocker</a> for more information on neurodocker recipes</p>
<h2 id=build-container>Build container</h2>
<p>To build a container:</p>
<ol>
<li>Pull-in latest changes from Neurodocker upstream into our fork: <a href=https://github.com/NeuroDesk/neurodocker>https://github.com/NeuroDesk/neurodocker</a> - add recipe to neurodocker if relevant for their project (<a href=https://github.com/NeuroDesk/neurodocker>https://github.com/NeuroDesk/neurodocker</a>) and create a pull request to neurodocker (add new tool in a branch!)</li>
<li>Clone the neurocontainers repository <a href=https://github.com/NeuroDesk/neurocontainers>https://github.com/NeuroDesk/neurocontainers</a></li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>git clone https://github.com/NeuroDesk/neurocontainers/
</code></pre></div><ol start=3>
<li>Copy the directory template and rename to <em>newapp</em> in <code>neurocontainers/recipes</code></li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>cd neurocontainers/recipes
cp -R template newapp
</code></pre></div><ol start=4>
<li>Modify <code>build.sh</code> in <code>neurocontainers/recipes/newapp</code> to build your application and update README.md (make sure the version is correct in the README!)</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>cd newapp
(edit build.sh as required)
(edit README.md as required)
</code></pre></div><ol start=5>
<li>Run update-builders.sh - This will auto-create the CI workflow for the application (or manually duplicate the template file and rename all occurances of template to <em>newapp</em>)</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>cd ../..
sh update-builders.sh
</code></pre></div><ol start=6>
<li>Build the container locally (e.g. running the build script with the &ndash;debug flag: <a href=https://github.com/NeuroDesk/neurocontainers/blob/master/recipes/lcmodel/build.sh>https://github.com/NeuroDesk/neurocontainers/blob/master/recipes/lcmodel/build.sh</a>)</li>
<li>updated changes in local git repository</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>git add recipes/newapp/build.sh recipes/newapp/README.md .github/workflows/newapp.yml
git config user.email &#34;the email that you use for github&#34;
git config user.name &#34;your name&#34;
git commit
</code></pre></div><ol start=8>
<li>Generate git personal access token (if you don’t have one already)</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>Browse to https://github.com/NeuroDesk/neurocontainers/
Press on your picture in upper right corner --&gt; Setting --&gt; Developer Settings --&gt; Personal Access Token
Press on “generate personal access token”
Write something in “Notes” (doesn’t matter what, it’s for your own use)
Check “repo”
Check “Workflow”
Press “Generate Token” at the bottom
Copy the token displayed on the screen into a file, so you’ll have it later
</code></pre></div><ol start=9>
<li>Test the container locally, and if successful push repo to trigger the automatic build on GitHub</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>git pull
git push
</code></pre></div><ol start=10>
<li>Go to neurocontainers/actions. Check that the most recent workflow run in the list terminated successfully (green). Otherwise, click on it, click on “build docker”, and the line that caused the error will be highlighted</li>
<li>Check that the package shows up in repository
Go to <a href="https://github.com/orgs/NeuroDesk/packages?repo_name=neurocontainers">https://github.com/orgs/NeuroDesk/packages?repo_name=neurocontainers</a> and check that the new package is listed</li>
<li>Try to manually download the package to your Machine or VNM</li>
</ol>
<div class=highlight><pre tabindex=0 style=background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-fallback data-lang=fallback>bash /neurodesk/local/fetch_and_run.sh newapp newappversion builddate
ml newapp/newappversion
</code></pre></div><ol start=13>
<li>Test the new container. Run some commands, to see all is good</li>
<li>send a pull request to add the container to the apps.json file: <a href=https://github.com/NeuroDesk/neurocommand/blob/main/neurodesk/apps.json>https://github.com/NeuroDesk/neurocommand/blob/main/neurodesk/apps.json</a></li>
<li>(once pull request is merged this will trigger an action to build the singularity container, distribute it in all object storage locations and on CVMFS, and it will update the menus in the desktop image on the next daily build)</li>
</ol>
<div class="text-muted mt-5 pt-3 border-top">
Last modified
September 23, 2021
: <a href=https://github.com/NeuroDesk/neurodesk.github.io/commit/f6f47adaa9b3c40338bc4b8d1e3118fb82344cab>added Oren's suggestions (f6f47ad)</a>
</div>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label>
<a class=text-white target=_blank rel=noopener href aria-label>
<i></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=Twitter aria-label=Twitter>
<a class=text-white target=_blank rel=noopener href=https://twitter.com/neuro_desk aria-label=Twitter>
<i class="fab fa-twitter"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=RSS aria-label=RSS>
<a class=text-white target=_blank rel=noopener href=https://neurodesk.github.io/blog/index.xml aria-label=RSS>
<i class="fas fa-rss"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label>
<a class=text-white target=_blank rel=noopener href aria-label>
<i></i>
</a>
</li>
</ul>
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
<ul class="list-inline mb-0">
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title=GitHub aria-label=GitHub>
<a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk aria-label=GitHub>
<i class="fab fa-github"></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title aria-label>
<a class=text-white target=_blank rel=noopener href aria-label>
<i></i>
</a>
</li>
<li class="list-inline-item mx-2 h3" data-toggle=tooltip data-placement=top title="Dicussion Forum (requires github login)" aria-label="Dicussion Forum (requires github login)">
<a class=text-white target=_blank rel=noopener href=https://github.com/NeuroDesk/neurodesk.github.io/discussions aria-label="Dicussion Forum (requires github login)">
<i class="fa fa-envelope"></i>
</a>
</li>
</ul>
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.f6e5038a2fe223cb025ddb9e3f0d6e61c17f7ee07173fa91a33f23be1ed1ab52.js integrity="sha256-9uUDii/iI8sCXduePw1uYcF/fuBxc/qRoz8jvh7Rq1I=" crossorigin=anonymous></script>
<script src=/js/prism.js></script>
</body>
</html>